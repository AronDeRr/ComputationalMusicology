---
title: "Computational Musicology portfolio by Aron de Ruijter"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(remotes)
library(tidyverse)
library(usethis)
library(spotifyr)
library(ggplot2)
library(knitr)
library(compmus)
spotifyr::get_spotify_access_token()
```

### Introduction to Fleetwood Mac and the purpose of the corpus

My corpus consists of the 17 studio albums released by the band Fleetwood Mac. Also known in the earlier years as Peter Green's Fleetwood Mac. I choose this corpus, because Fleetwood Mac is my favorite musical artist and the band has topped my Spotify wrapped ever since I got a Spotify subscription a few years ago. 
I think this corpus will be interesting, because there have been a lot of changes to the bands line-up, especially in their earlier years. Below is a list of the albums and the changes of the band members (and their primary instruments) that helped create the album. Only two band members, Mick Fleetwood (drums) and John McVie (bass), have been in the band since the start and have performed on every album. Which is why their names are not included in the list.

<details>
<summary>Albums and the changes in band line-ups</summary>
<br>
  
\+ Peter Green (guitar/ lead and backing vocals), Jeremy Spencer (slide guitar/ piano /lead and backing vocals), 
- Fleetwood Mac (1968) (Also known as Peter Green's Fleetwood Mac)
- Mr. Wonderful (1968)

\+ Danny Kirwan (guitar/ lead and backing vocals)
- Then Play On (1969)

\- Peter Green
- Kiln House (1970)

\- Jeremy Spencer \+ Bob Welch (guitar/ lead and backing vocals), Christine McVie (keyboards/ lead and backing vocals)
- Future Games (1971)
- Bare Trees (1972)

\- Danny Kirwan \+ Bob Weston (lead guitar/ backing vocals), Dave Walker (lead and backing vocals/ harmonica)
- Penguin (1973)

\- Dave Walker
- Mystery to Me (1973)

\- Bob Weston
- Heroes Are Hard to Find (1974)

\- Bob Welch \+ Lindsey Buckingham (guitar/ lead and backing vocals), Stevie Nicks (lead and backing vocals/ tambourine)
- Fleetwood Mac (1975) (Also known as "The White Album")
- Rumours (1977)
- Tusk (1979)
- Mirage (1982)
- Tango in the Night (1987)

\- Lindsey Buckingham \+ Billy Burnette (rhythm guitar/ backing and lead vocals), Rick Vito (lead guitar/ backing and lead vocals)
- Behind the Mask (1990)

\- Stevie Nicks, Rick Vito \+ Bekka Bramlett (lead and backing vocals), Dave Mason (lead guitar/ backing and lead vocals)
- Time (1995)

\- Billy Burnette, Bekka Bramlett, Dave Mason, Christine McVie \+ Lindsey Buckingham, Stevie Nicks
- Say You Will (2003)

\- Lindsey Buckingham \+ Christine McVie, Neil Finn (rhythm guitar/ lead and backing vocals), Mike Campbell (lead guitar)
</details>
<br>
  
The band started out as a blues band, but since the addition of Christine McVie after the album "Kiln House" the style of the band shifted to rock. I expect there to be quite a few differences between these earlier albums and the others. 
Their second self-titled album was the breakthrough for the band and got them global success. This was the first album released since the addition of the duo Lindsey Buckingham and Stevey Nicks. The members of the band that released this album is the most well known line-up and brought the band the most succes in the 5 albums they released as a core. It will be interesting to look at what this line-up did different, that brought them this success.

### Album valence and energy comparison.

![image](./figures/ValencVSEnergy.png)

***

* This plot shows the valence versus the energy of each track on each album. The popularity of the track is given by the size of the dot and the colour represents if the song is in a minor or major key. 

* Tracks with high valence sound more positive, while tracks with low valence sound more negative. The energy of a track represents a perceptual measure of intensity and activity.

* Every album since Mirage sounds more positive, while albums before that had a more spread out valence. 

* The album Rumours is the most popular albums, having a lot of high energy songs and a spread out valence. But just having high energy songs is not enough to make an album popular, this can be seen on the albums Bare Trees and Penguin.

<!-- # ```{r} -->
<!-- # fleetwoodMac <- get_playlist_audio_features("", "1NdovVKsJylONwiE6WXwB5") -->
<!-- #  -->
<!-- # fleetwoodMac$track.album.name[fleetwoodMac$track.album.name == "Fleetwood Mac"] <- "Fleetwood Mac 1" -->
<!-- # fleetwoodMac$track.album.name[fleetwoodMac$track.album.name == "Then Play On (2013 Remaster; Expanded Edition)"] <- "Then Play On" -->
<!-- # fleetwoodMac$track.album.name[fleetwoodMac$track.album.name == "Fleetwood Mac (2017 Remaster)"] <- "Fleetwood Mac 2" -->
<!-- # fleetwoodMac$track.album.name[fleetwoodMac$track.album.name == "Tusk (2015 Remaster)"] <- "Tusk" -->
<!-- # fleetwoodMac$track.album.name[fleetwoodMac$track.album.name == "Mirage (2016 Remaster)"] <- "Mirage" -->
<!-- # fleetwoodMac$track.album.name[fleetwoodMac$track.album.name == "Tango in the Night (2017 Remaster)"] <- "Tango in the Night" -->
<!-- #  -->
<!-- # ggplot(fleetwoodMac, aes(energy, valence, size = track.popularity, colour = mode_name)) + -->
<!-- #  geom_point() + -->
<!-- #  facet_wrap(~track.album.release_date + track.album.name, nrow=8)  + -->
<!-- #  labs(x = "Valence", y = "Energy", colour = "Mode", size = "Track Popularity") -->
<!-- # ```  -->

<!-- Column {data-width=350} -->
<!-- ----------------------------------------------------------------------- -->
### Chart B

```{r}

landslide_live_1997 <-
  get_tidy_audio_analysis("06h9kk12VjJ2bqcBc6IScR") %>%
  select(segments) %>%
  unnest(segments) %>%
  select(start, duration, pitches)

landslide_studio <-
  get_tidy_audio_analysis("5ihS6UUlyQAfmp48eSkxuQ") %>%
  select(segments) %>%
  unnest(segments) %>%
  select(start, duration, pitches)

landslide_live_1975 <-
  get_tidy_audio_analysis("53IkukOzY8ZnDfr4AdVuql") %>%
  select(segments) %>%
  unnest(segments) %>%
  select(start, duration, pitches)

landslide_studio %>%
  mutate(pitches = map(pitches, compmus_normalise, "chebyshev")) %>%
  compmus_gather_chroma() %>% 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title="Landslide (studio version)") +
  theme_minimal() +
  scale_fill_viridis_c()

landslide_live_1975 %>%
  mutate(pitches = map(pitches, compmus_normalise, "chebyshev")) %>%
  compmus_gather_chroma() %>%
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title = "Landslide (live version 1975") +
  theme_minimal() +
  scale_fill_viridis_c()

landslide_live_1997 %>%
  mutate(pitches = map(pitches, compmus_normalise, "chebyshev")) %>%
  compmus_gather_chroma() %>% 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title = "Landslide (live version 1997") +
  theme_minimal() +
  scale_fill_viridis_c()

```

***

* Studio version with electric guitar solo

* Live 1975 version electric guitar solo replaced by piano solo

* Live 1997 version adjusted guitar solo that is played by accoustic guitar. making the entire song played only by an accoustic guitar

* not sure why the second one is smaller

<!-- ### Chart C -->

<!-- ```{r} -->

<!-- ``` -->

